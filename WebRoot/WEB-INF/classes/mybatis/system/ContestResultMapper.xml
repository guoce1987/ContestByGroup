<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ContestResultMapper">
	
	<resultMap type="ContestResult" id="contestResultMap">
		<result column="StatDate" property="StatDate"/>
		<result column="RJ_SafetyScore" property="RJ_SafetyScore"/>
		<result column="RJ_PowerScore" property="RJ_PowerScore"/>
		<result column="RJ_HeatScore" property="RJ_HeatScore"/>
		<result column="RJ_EconomyScore" property="RJ_EconomyScore"/>
		<result column="RJ_BugScore" property="RJ_BugScore"/>
		<result column="RJ_PotralScore" property="RJ_PotralScore"/>
		<result column="RJ_TrainScore" property="RJ_TrainScore"/>
		<result column="RJ_SpiritScore" property="RJ_SpiritScore"/>
		<result column="RJ_TotalScore" property="RJ_TotalScore"/>
	</resultMap>
	
	<resultMap type="ContestResultForChart" id="contestResultMapForChart">
		<result column="ID" property="ID"/>
		<result column="ID1" property="ID1"/>
		<result column="Item" property="Item"/>
		<result column="G1" property="G1"/>
		<result column="G2" property="G2"/>
		<result column="G3" property="G3"/>
		<result column="G4" property="G4"/>
		<result column="G5" property="G5"/>
		<result column="G6" property="G6"/>
	</resultMap>
	
	<!-- 列出所有的竞赛结果 -->
	<select id="listAllContestResult" resultMap="contestResultMap" parameterType="pd">
		select 
		 CONVERT(varchar(100), StatDate, 23) as StatDate,
		  RJ_SafetyScore,
		  RJ_PowerScore,
		  RJ_HeatScore,
		  RJ_EconomyScore,
		  RJ_BugScore,
		  RJ_PotralScore,
		  RJ_TrainScore,
		  RJ_SpiritScore,
		  RJ_TotalScore
		 from vw_ContestResult
		 where year(StatDate)= #{year} and month(StatDate) = #{month}
	</select>
	

		<!-- 调用竞赛结果存储过程 -->
	<select id="listAllContestResultByProcedure" resultMap="contestResultMapForChart" statementType="CALLABLE" parameterType="pd">
	
	     { call dbo.query_ContestResult_ReportPivot_RJ(#{year,jdbcType=INTEGER},#{month,jdbcType=INTEGER}) }

	</select>
	
	<!-- 安全指标 -->
	<resultMap type="SecurityIndexForChart" id="securityIndexMapForChart">
		<result column="GroupName" property="GroupName"/>
		<result column="RJ_SafetyScore" property="RJ_SafetyScore"/>
	</resultMap>
	
	<resultMap type="SecurityIndexForGrid" id="securityIndexMapForGrid">
		<result column="ID" property="ID"/>
		<result column="CheckDate" property="CheckDate"/>
		<result column="GroupName" property="GroupName"/>
		<result column="ItemName" property="ItemName"/>
		<result column="Score" property="Score"/>
		<result column="Money" property="Money"/>
		<result column="Memo" property="Memo"/>
		<result column="ContestItem" property="ContestItem"/>
		
	</resultMap>
	
	<!-- 列出所有的安全指标(图) -->
	<select id="listAllSecurityIndexForChart" resultMap="securityIndexMapForChart">
			select 
 			GroupName,
 			RJ_SafetyScore
 			from vw_ContestResult
	</select>
	<!-- 列出所有的安全指标(表) -->
	<select id="listAllSecurityIndexForGrid" resultMap="securityIndexMapForGrid"  parameterType="pd">
			SELECT 	
			ID,
		    CheckDate, 
		    GroupName, 
		 	ItemName, 
		    Score, 
		    Money, 
		    Memo,
		    ContestItem
			FROM Vw_RewardPunishLog
			WHERE ContestItemid=1 AND YEAR(CheckDate)= #{year} AND MONTH(CheckDate) = #{month}
			ORDER BY CheckDate desc
	</select>
	
	<!-- 电量指标 -->
	<resultMap type="PoweIndexForChart" id="powerIndexMapForChart">
		<result column="GroupName" property="GroupName"/>
		<result column="RJ_GeneratePowerAvg" property="RJ_GeneratePowerAvg"/>
	</resultMap>
	
	<resultMap type="PowerIndexForGrid" id="powerIndexMapForGrid">
		<result column="DutyID" property="DutyID"/>
		<result column="StatDate" property="StatDate"/>
		<result column="DutyName" property="DutyName"/>
		<result column="GroupName" property="GroupName"/>
		<result column="RJ_GeneratePower" property="RJ_GeneratePower"/>
	</resultMap>
	
	<!-- 列出所有的电量指标(图) -->
	<select id="listAllPowerIndexForChart" resultMap="powerIndexMapForChart">
			select 
			groupName,
			RJ_GeneratePowerAvg  
			from vw_ContestResult
	</select>
	<!-- 列出所有的电量指标(表) -->
	<select id="listAllPowerIndexForGrid" resultMap="powerIndexMapForGrid"  parameterType="pd">
			SELECT 
			 DutyID, 
			 StatDate, 
			 DutyName, 
			 GroupName, 
			 RJ_GeneratePower  
			FROM vw_CoalCost
			WHERE (YEAR(statDate) = #{year}) AND (MONTH(statDate) = #{month}) Order by Statdate desc,Dutyid desc
	</select>

</mapper>